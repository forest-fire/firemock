{"version":3,"file":"firemock.cjs.js","sources":["esnext/util.js","esnext/database.js","esnext/mock.js","esnext/schema-helper.js","esnext/snapshot.js","esnext/queue.js","esnext/query.js","esnext/reference.js","esnext/pluralize.js","esnext/schema.js","esnext/Deployment.js"],"sourcesContent":["import { first, last } from \"lodash\";\nexport function normalizeRef(r) {\n    r = r.replace(\"/\", \".\");\n    r = r.slice(0, 1) === \".\" ? r.slice(1) : r;\n    return r;\n}\nexport function parts(r) {\n    return normalizeRef(r).split(\".\");\n}\n/**\n * return the last component of the path\n * which typically would represent the 'id'\n * of a list-node\n */\nexport function leafNode(r) {\n    return parts(r).pop();\n}\nexport function getRandomInt(min, max) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\nexport function firstProp(listOf) {\n    return listOf ? listOf[firstKey(listOf)] : {};\n}\nexport function lastProp(listOf) {\n    return listOf[lastKey(listOf)];\n}\nexport function objectIndex(obj, index) {\n    const keys = Object.keys(obj);\n    return keys ? obj[keys[index - 1]] : null;\n}\nexport function firstKey(listOf) {\n    return first(Object.keys(listOf));\n}\nexport function lastKey(listOf) {\n    return last(Object.keys(listOf));\n}\nexport function removeKeys(obj, remove) {\n    return Object.keys(obj).reduce((agg, v) => {\n        if (remove.indexOf(v) === -1) {\n            agg[v] = obj[v];\n        }\n        return agg;\n    }, {});\n}\n/**\n * Joins a set of paths together and converts into\n * correctly formatted \"dot notation\" directory path\n */\nexport function join(...paths) {\n    return paths\n        .map(p => {\n        return p.replace(/[\\/\\\\]/gm, \".\");\n    })\n        .map(p => (p.slice(-1) === \".\" ? p.slice(0, p.length - 1) : p))\n        .map(p => (p.slice(0, 1) === \".\" ? p.slice(1) : p))\n        .join(\".\");\n}\nexport function pathDiff(longPath, pathSubset) {\n    const subset = pathSubset.split(\".\");\n    const long = longPath.split(\".\");\n    if (subset.length > long.length ||\n        JSON.stringify(long.slice(0, subset.length)) !== JSON.stringify(subset)) {\n        throw new Error(`\"${pathSubset}\" is not a subset of ${longPath}`);\n    }\n    return long.length === subset.length\n        ? \"\"\n        : long.slice(subset.length - long.length).join(\".\");\n}\nexport function orderedSnapToJS(snap) {\n    const jsObject = {};\n    snap.forEach(record => (jsObject[record.key] = record.val()));\n    return jsObject;\n}\n/**\n * Given a path, returns the parent path and child key\n */\nexport function keyAndParent(dotPath) {\n    const sections = dotPath.split(\".\");\n    const key = sections.pop();\n    const parent = sections.join(\".\");\n    return { parent, key };\n}\n/** converts a '/' delimited path to a '.' delimited one */\nexport function dotNotation(path) {\n    path = path.slice(0, 1) === \"/\" ? path.slice(1) : path;\n    return path ? path.replace(/\\//g, \".\") : undefined;\n}\nexport function slashNotation(path) {\n    return path.replace(/\\./g, \"/\");\n}\n/** Get the parent DB path */\nexport function getParent(dotPath) {\n    return keyAndParent(dotPath).parent;\n}\n/** Get the Key from the end of a path string */\nexport function getKey(dotPath) {\n    return keyAndParent(dotPath).key;\n}\n/** named network delays */\nexport var Delays;\n(function (Delays) {\n    Delays[\"random\"] = \"random\";\n    Delays[\"weak\"] = \"weak-mobile\";\n    Delays[\"mobile\"] = \"mobile\";\n    Delays[\"WiFi\"] = \"WIFI\";\n})(Delays || (Delays = {}));\nlet _delay = 5;\nexport function setNetworkDelay(value) {\n    _delay = value;\n}\nexport function networkDelay(returnValue) {\n    return new Promise(resolve => {\n        setTimeout(() => {\n            if (returnValue) {\n                resolve(returnValue);\n            }\n            else {\n                resolve();\n            }\n        }, calcDelay());\n    });\n}\nfunction calcDelay() {\n    const delay = _delay;\n    if (typeof delay === \"number\") {\n        return delay;\n    }\n    if (Array.isArray(delay)) {\n        const [min, max] = delay;\n        return getRandomInt(min, max);\n    }\n    if (typeof delay === \"object\" && !Array.isArray(delay)) {\n        const { min, max } = delay;\n        return getRandomInt(min, max);\n    }\n    // these numbers need some reviewing\n    if (delay === \"random\") {\n        return getRandomInt(10, 300);\n    }\n    if (delay === \"weak\") {\n        return getRandomInt(400, 900);\n    }\n    if (delay === \"mobile\") {\n        return getRandomInt(300, 500);\n    }\n    if (delay === \"WIFI\") {\n        return getRandomInt(10, 100);\n    }\n    throw new Error(\"Delay property is of unknown format: \" + delay);\n}\n","import { set, get } from \"lodash\";\nimport { key as fbKey } from \"firebase-key\";\nimport { join, pathDiff, getParent, getKey, keyAndParent } from \"./util\";\nimport { SnapShot } from \"./index\";\nexport let db = [];\nlet _listeners = [];\nexport function clearDatabase() {\n    db = {};\n}\nexport function updateDatabase(state) {\n    db = Object.assign({}, db, state);\n}\nexport function setDB(path, value) {\n    const dotPath = join(path);\n    const oldValue = get(db, dotPath);\n    set(db, dotPath, value);\n    notify(dotPath, value, oldValue);\n}\n/** single-path update */\nexport function updateDB(path, value) {\n    const dotPath = join(path);\n    const oldValue = get(db, dotPath);\n    const newValue = typeof oldValue === \"object\" ? Object.assign({}, oldValue, value) : value;\n    set(db, dotPath, newValue);\n    notify(dotPath, newValue, oldValue);\n}\nexport function multiPathUpdateDB(data) {\n    Object.keys(data).map(key => setDB(key, data[key]));\n}\nexport function removeDB(path) {\n    const dotPath = join(path);\n    const oldValue = get(db, dotPath);\n    const parentValue = get(db, getParent(dotPath));\n    if (typeof parentValue === \"object\") {\n        delete parentValue[getKey(dotPath)];\n        set(db, getParent(dotPath), parentValue);\n    }\n    else {\n        set(db, dotPath, undefined);\n    }\n    notify(dotPath, undefined, oldValue);\n}\nexport function pushDB(path, value) {\n    const pushId = fbKey();\n    const fullPath = join(path, pushId);\n    setDB(fullPath, value);\n    return pushId;\n}\nexport function addListener(path, eventType, callback, cancelCallbackOrContext, context) {\n    _listeners.push({\n        path: join(path),\n        eventType,\n        callback,\n        cancelCallbackOrContext,\n        context\n    });\n}\nexport function removeListener(eventType, callback, context) {\n    if (!eventType) {\n        return removeAllListeners();\n    }\n    if (!callback) {\n        const removed = _listeners.filter(l => l.eventType === eventType);\n        _listeners = _listeners.filter(l => l.eventType !== eventType);\n        return cancelCallback(removed);\n    }\n    if (!context) {\n        const removed = _listeners\n            .filter(l => l.callback === callback)\n            .filter(l => l.eventType === eventType);\n        _listeners = _listeners.filter(l => l.eventType !== eventType || l.callback !== callback);\n        return cancelCallback(removed);\n    }\n    else {\n        const removed = _listeners\n            .filter(l => l.callback === callback)\n            .filter(l => l.eventType === eventType)\n            .filter(l => l.context === context);\n        _listeners = _listeners.filter(l => l.context !== context || l.callback !== callback || l.eventType !== eventType);\n        return cancelCallback(removed);\n    }\n}\nfunction cancelCallback(removed) {\n    let count = 0;\n    removed.forEach(l => {\n        if (typeof l.cancelCallbackOrContext === \"function\") {\n            l.cancelCallbackOrContext();\n            count++;\n        }\n    });\n    return count;\n}\nexport function removeAllListeners() {\n    const howMany = cancelCallback(_listeners);\n    _listeners = [];\n    return howMany;\n}\nexport function listenerCount(type) {\n    return type ? _listeners.filter(l => l.eventType === type).length : _listeners.length;\n}\nexport function listenerPaths(type) {\n    return type\n        ? _listeners.filter(l => l.eventType === type).map(l => l.path)\n        : _listeners.map(l => l.path);\n}\n/**\n * Notifies all appropriate \"child\" event listeners when changes\n * in state happen\n *\n * @param dotPath the path where the change was made\n * @param newValue the new value\n * @param oldValue the prior value\n */\nfunction notify(dotPath, newValue, oldValue) {\n    if (JSON.stringify(newValue) !== JSON.stringify(oldValue)) {\n        findValueListeners(dotPath).map(l => {\n            let result = {};\n            const listeningRoot = get(db, l.path);\n            if (typeof listeningRoot === \"object\" && !newValue) {\n                result = get(db, l.path);\n                delete result[getKey(dotPath)];\n            }\n            else {\n                set(result, pathDiff(dotPath, l.path), newValue);\n            }\n            return l.callback(new SnapShot(join(l.path), result));\n        });\n        if (newValue === undefined) {\n            const { parent, key } = keyAndParent(dotPath);\n            findChildListeners(parent, \"child_removed\", \"child_changed\").forEach(l => {\n                return l.callback(new SnapShot(key, newValue));\n            });\n        }\n        else if (oldValue === undefined) {\n            const { parent, key } = keyAndParent(dotPath);\n            findChildListeners(parent, \"child_added\", \"child_changed\").forEach(l => {\n                return l.callback(new SnapShot(key, newValue));\n            });\n        }\n    }\n}\n/**\n * Finds \"child events\" listening to a given parent path; optionally\n * allowing for specification of the specific event type\n *\n * @param path the parent path that children are detected off of\n * @param eventType <optional> the specific child event to filter down to\n */\nexport function findChildListeners(path, ...eventType) {\n    const correctPath = _listeners.filter(l => l.path === join(path) && l.eventType !== \"value\");\n    return eventType.length > 0\n        ? correctPath.filter(l => eventType.indexOf(l.eventType) !== -1)\n        : correctPath;\n}\n/**\n * Finds all value listeners on a given path or below.\n * Unlike child listeners, Value listeners listen to changes at\n * all points below the registered path.\n *\n * @param path path to root listening point\n */\nexport function findValueListeners(path) {\n    return _listeners.filter(l => join(path).indexOf(join(l.path)) !== -1 && l.eventType === \"value\");\n}\n/** Clears the DB and removes all listeners */\nexport function reset() {\n    removeAllListeners();\n    clearDatabase();\n}\n","import { Queue, Schema, Reference, Deployment } from \"./index\";\nimport { db, clearDatabase, updateDatabase } from \"./database\";\nimport { setNetworkDelay } from \"./util\";\n/* tslint:disable:max-classes-per-file */\nexport default class Mock {\n    constructor(raw) {\n        this._schemas = new Queue(\"schemas\").clear();\n        this._relationships = new Queue(\"relationships\").clear();\n        this._queues = new Queue(\"queues\").clear();\n        Queue.clearAll();\n        clearDatabase();\n        if (raw) {\n            this.updateDB(raw);\n        }\n    }\n    /**\n     * Update the mock DB with a raw JS object/hash\n     */\n    updateDB(state) {\n        updateDatabase(state);\n    }\n    get db() {\n        return db;\n    }\n    addSchema(schema, mock) {\n        const s = new Schema(schema);\n        if (mock) {\n            s.mock(mock);\n        }\n        return new Schema(schema);\n    }\n    /** Set the network delay for queries with \"once\" */\n    setDelay(d) {\n        setNetworkDelay(d);\n    }\n    get deploy() {\n        return new Deployment();\n    }\n    queueSchema(schemaId, quantity = 1, overrides = {}) {\n        const d = new Deployment();\n        d.queueSchema(schemaId, quantity, overrides);\n        return d;\n    }\n    generate() {\n        return new Deployment().generate();\n    }\n    ref(dbPath) {\n        return new Reference(dbPath);\n    }\n}\n","export default class SchemaHelper {\n    constructor(raw) {\n        this._db = raw;\n    }\n    get faker() {\n        const faker = require(\"faker\");\n        return faker;\n    }\n    get chance() {\n        const chance = require(\"chance\");\n        return chance();\n    }\n}\n","import { get } from \"lodash\";\nimport Reference from \"./reference\";\nimport * as convert from \"typed-conversions\";\nimport { getKey, join } from \"./util\";\nexport default class SnapShot {\n    constructor(_key, _value) {\n        this._key = _key;\n        this._value = _value;\n    }\n    get key() {\n        return getKey(join(this._key));\n    }\n    get ref() {\n        return new Reference(this._key);\n    }\n    val() {\n        return Array.isArray(this._value) ? convert.arrayToHash(this._value) : this._value;\n    }\n    toJSON() {\n        return JSON.stringify(this._value);\n    }\n    child(path) {\n        const value = get(this._value, path, null);\n        return value ? new SnapShot(path, value) : null;\n    }\n    hasChild(path) {\n        if (typeof this._value === \"object\") {\n            return Object.keys(this._value).indexOf(path) !== -1;\n        }\n        return false;\n    }\n    hasChildren() {\n        if (typeof this._value === \"object\") {\n            return Object.keys(this._value).length > 0;\n        }\n        return false;\n    }\n    numChildren() {\n        if (typeof this._value === \"object\") {\n            return Object.keys(this._value).length;\n        }\n        return 0;\n    }\n    exists() {\n        return this._value !== null;\n    }\n    forEach(actionCb) {\n        const cloned = this._value.slice(0);\n        const sorted = cloned.sort(this._sortingFunction);\n        sorted.map((item) => {\n            const noId = Object.assign({}, item);\n            delete noId.id;\n            const halt = actionCb(new SnapShot(item.id, noId));\n            if (halt) {\n                return true;\n            }\n        });\n        return false;\n    }\n    /** NOTE: mocking proxies this call through to val(), no use of \"priority\" */\n    exportVal() {\n        return this.val();\n    }\n    getPriority() {\n        return null;\n    }\n    /**\n     * Used by Query objects to instruct the snapshot the sorting function to use\n     */\n    sortingFunction(fn) {\n        this._sortingFunction = fn;\n        return this;\n    }\n}\n","import { first } from \"lodash\";\nimport * as fbKey from \"firebase-key\";\n/**\n * Queue Class\n *\n * A generic class for building singleton queues;\n * this is used as a container for schemas, deployment queues,\n * and relationships\n */\nexport default class Queue {\n    constructor(_name) {\n        this._name = _name;\n        this.pkProperty = \"id\";\n        if (!_name) {\n            throw new Error(\"A queue MUST have a named passed in to be managed\");\n        }\n        if (!Queue._queues[_name]) {\n            Queue._queues[_name] = [];\n        }\n    }\n    static clearAll() {\n        Queue._queues = {};\n    }\n    get name() {\n        return this._name;\n    }\n    /**\n     * Allows adding another item to the queue. It is expected\n     * that this item WILL have the primary key included ('id' by\n     * default)\n     */\n    enqueue(queueItem) {\n        Queue._queues[this._name].push(queueItem);\n        return this;\n    }\n    /**\n     * Similar to enqueue but the primary key is generated and passed\n     * back to the caller.\n     */\n    push(queueItem) {\n        const id = fbKey.key();\n        if (typeof queueItem !== \"object\") {\n            throw new Error(\"Using push() requires that the payload is an object\");\n        }\n        queueItem[this.pkProperty] = id;\n        this.enqueue(queueItem);\n        return id;\n    }\n    /**\n     * By passing in the key you will remove the given item from the queue\n     */\n    dequeue(key) {\n        const queue = Queue._queues[this._name];\n        if (queue.length === 0) {\n            throw new Error(`Queue ${this._name} is empty. Can not dequeue ${key}.`);\n        }\n        Queue._queues[this._name] =\n            typeof first(queue) === \"object\"\n                ? queue.filter((item) => item[this.pkProperty] !== key)\n                : queue.filter((item) => item !== key);\n        return this;\n    }\n    fromArray(payload) {\n        Queue._queues[this._name] = payload;\n        return this;\n    }\n    clear() {\n        Queue._queues[this._name] = [];\n        return this;\n    }\n    find(key) {\n        const [obj, index] = this._find(key);\n        return obj;\n    }\n    indexOf(key) {\n        const [obj, index] = this._find(key);\n        return index;\n    }\n    includes(key) {\n        return this.find(key) ? true : false;\n    }\n    replace(key, value) {\n        value[this.pkProperty] = key;\n        this.dequeue(key).enqueue(value);\n        return this;\n    }\n    update(key, value) {\n        const currently = this.find(key);\n        if (currently) {\n            this.dequeue(key);\n        }\n        if (typeof currently === \"object\" && typeof value === \"object\") {\n            value[this.pkProperty] = key;\n            const updated = Object.assign({}, currently, value);\n            this.enqueue(updated);\n        }\n        else {\n            throw new Error(`Current and updated values must be objects!`);\n        }\n        return this;\n    }\n    get length() {\n        return Queue._queues[this._name].length;\n    }\n    /** returns the Queue as a JS array */\n    toArray() {\n        return Queue._queues && Queue._queues[this._name] ? Queue._queues[this._name] : [];\n    }\n    /** returns the Queue as a JS Object */\n    toHash() {\n        const queue = Queue._queues[this._name];\n        if (!queue || queue.length === 0) {\n            return new Object();\n        }\n        return typeof first(queue) === \"object\"\n            ? queue.reduce((obj, item) => {\n                const pk = item[this.pkProperty];\n                // tslint:disable-next-line\n                const o = Object.assign({}, item);\n                delete o[this.pkProperty];\n                return Object.assign({}, obj, { [pk]: o });\n            }, new Object())\n            : queue.reduce((obj, item) => (obj = Object.assign({}, obj, { [item]: true })), new Object());\n    }\n    map(fn) {\n        const queuedSchemas = Queue._queues[this._name];\n        return queuedSchemas ? queuedSchemas.map(fn) : [];\n    }\n    filter(fn) {\n        const queue = Queue._queues[this._name];\n        return queue ? queue.filter(fn) : [];\n    }\n    toJSON() {\n        return JSON.stringify(Queue._queues);\n    }\n    toObject() {\n        return Queue._queues;\n    }\n    _find(key) {\n        const queue = Queue._queues[this._name];\n        const objectPayload = typeof first(queue) === \"object\";\n        let index = 0;\n        let result = [null, -1];\n        for (const item of queue) {\n            const condition = objectPayload ? item[this.pkProperty] === key : item === key;\n            if (condition) {\n                result = [item, index];\n                break;\n            }\n            index++;\n        }\n        return result;\n    }\n}\nQueue._queues = {};\n","import { db, addListener } from \"./database\";\nimport { get } from \"lodash\";\nimport SnapShot from \"./snapshot\";\nimport Queue from \"./queue\";\nimport * as convert from \"typed-conversions\";\nimport Reference from \"./reference\";\nimport { join, leafNode, networkDelay } from \"./util\";\nexport var OrderingType;\n(function (OrderingType) {\n    OrderingType[\"byChild\"] = \"child\";\n    OrderingType[\"byKey\"] = \"key\";\n    OrderingType[\"byValue\"] = \"value\";\n})(OrderingType || (OrderingType = {}));\n/** tslint:ignore:member-ordering */\nexport default class Query {\n    constructor(path, _delay = 5) {\n        this.path = path;\n        this._delay = _delay;\n        this._order = { type: OrderingType.byKey, value: null };\n        this._listeners = new Queue(\"listeners\");\n        this._limitFilters = [];\n        this._queryFilters = [];\n    }\n    get ref() {\n        return new Reference(this.path, this._delay);\n    }\n    limitToLast(num) {\n        const filter = resultset => {\n            return resultset.slice(resultset.length - num);\n        };\n        this._limitFilters.push(filter);\n        return this;\n    }\n    limitToFirst(num) {\n        const filter = resultset => {\n            return resultset.slice(0, num);\n        };\n        this._limitFilters.push(filter);\n        return this;\n    }\n    equalTo(value, key) {\n        if (key && this._order.type === OrderingType.byKey) {\n            throw new Error(\"You can not use equalTo's key property when using a key sort!\");\n        }\n        key = key ? key : this._order.value;\n        const filter = (resultset) => {\n            let comparison = item => item[key];\n            if (!key) {\n                switch (this._order.type) {\n                    case OrderingType.byChild:\n                        comparison = item => item[this._order.value];\n                        break;\n                    case OrderingType.byKey:\n                        comparison = item => item.id;\n                        break;\n                    case OrderingType.byValue:\n                        comparison = item => item;\n                        break;\n                    default:\n                        throw new Error(\"unknown ordering type: \" + this._order.type);\n                }\n            }\n            return resultset.filter((item) => comparison(item) === value);\n        };\n        this._queryFilters.push(filter);\n        return this;\n    }\n    /** Creates a Query with the specified starting point. */\n    startAt(value, key) {\n        key = key ? key : this._order.value;\n        const filter = resultset => {\n            return resultset.filter((record) => {\n                return key ? record[key] >= value : record >= value;\n            });\n        };\n        this._queryFilters.push(filter);\n        return this;\n    }\n    endAt(value, key) {\n        key = key ? key : this._order.value;\n        const filter = resultset => {\n            return resultset.filter((record) => {\n                return key ? record[key] <= value : record <= value;\n            });\n        };\n        this._queryFilters.push(filter);\n        return this;\n    }\n    on(eventType, callback, cancelCallbackOrContext, context) {\n        addListener(this.path, eventType, callback, cancelCallbackOrContext, context);\n        return null;\n    }\n    once(eventType) {\n        return networkDelay(this.process());\n    }\n    off() {\n        console.log(\"off() not implemented yet\");\n    }\n    /** NOT IMPLEMENTED YET */\n    isEqual(other) {\n        return false;\n    }\n    /**\n     * When the children of a query are all objects, then you can sort them by a\n     * specific property. Note: if this happens a lot then it's best to explicitly\n     * index on this property in the database's config.\n     */\n    orderByChild(prop) {\n        this._order = {\n            type: OrderingType.byChild,\n            value: prop\n        };\n        return this;\n    }\n    /**\n     * When the children of a query are all scalar values (string, number, boolean), you\n     * can order the results by their (ascending) values\n     */\n    orderByValue() {\n        this._order = {\n            type: OrderingType.byValue,\n            value: null\n        };\n        return this;\n    }\n    /**\n     * This is the default sort\n     */\n    orderByKey() {\n        this._order = {\n            type: OrderingType.byKey,\n            value: null\n        };\n        return this;\n    }\n    /** NOT IMPLEMENTED */\n    orderByPriority() {\n        return this;\n    }\n    toJSON() {\n        return JSON.stringify(this);\n    }\n    toString() {\n        return `${process.env.FIREBASE_DATA_ROOT_URL}/${this.path}`;\n    }\n    /**\n     * This is an undocumented API endpoint that is within the\n     * typing provided by Google\n     */\n    getKey() {\n        return null;\n    }\n    /**\n     * This is an undocumented API endpoint that is within the\n     * typing provided by Google\n     */\n    getParent() {\n        return null;\n    }\n    /**\n     * This is an undocumented API endpoint that is within the\n     * typing provided by Google\n     */\n    getRoot() {\n        return null;\n    }\n    /**\n     * Reduce the dataset using filters (after sorts) but do not apply sort\n     * order to new SnapShot (so natural order is preserved)\n     */\n    process() {\n        // typically a hash/object but could be a scalar type (string/number/boolean)\n        const input = get(db, join(this.path), undefined);\n        const hashOfHashes = typeof input === \"object\" &&\n            Object.keys(input).every(i => typeof input[i] === \"object\");\n        let snap;\n        if (!hashOfHashes) {\n            snap = new SnapShot(leafNode(this.path), input);\n        }\n        else {\n            const mockDatabaseResults = convert.hashToArray(input);\n            const sorted = this.processSorting(mockDatabaseResults);\n            const remainingIds = this.processFilters(sorted).map((f) => (typeof f === \"object\" ? f.id : f));\n            snap = new SnapShot(leafNode(this.path), mockDatabaseResults.filter((record) => remainingIds.indexOf(record.id) !== -1));\n        }\n        snap.sortingFunction(this.getSortingFunction(this._order));\n        return snap;\n    }\n    /**\n     * Processes all Filter Queries to reduce the resultset\n     */\n    processFilters(inputArray) {\n        let output = inputArray.slice(0);\n        this._queryFilters.forEach(q => (output = q(output)));\n        this._limitFilters.forEach(q => (output = q(output)));\n        return output;\n    }\n    processSorting(inputArray) {\n        const sortFn = this.getSortingFunction(this._order);\n        const sorted = inputArray.slice(0).sort(sortFn);\n        return sorted;\n    }\n    /**\n     * Returns a sorting function for the given Sort Type\n     */\n    getSortingFunction(sortType) {\n        let sort;\n        switch (sortType.type) {\n            case OrderingType.byKey:\n                sort = (a, b) => {\n                    return a.id > b.id ? -1 : a.id === b.id ? 0 : 1;\n                };\n                break;\n            case OrderingType.byValue:\n                sort = (a, b) => {\n                    return a.value > b.value ? -1 : a.value === b.value ? 0 : 1;\n                };\n                break;\n            case OrderingType.byChild:\n                const child = this._order.value;\n                sort = (a, b) => {\n                    return a[child] > b[child] ? -1 : a[child] === b[child] ? 0 : 1;\n                };\n                break;\n        }\n        return sort;\n    }\n}\n","import Query from \"./query\";\nimport { get } from \"lodash\";\nimport { db, setDB, updateDB, pushDB, removeDB, multiPathUpdateDB } from \"./database\";\nimport { parts, join, slashNotation, networkDelay } from \"./util\";\nfunction isMultiPath(data) {\n    Object.keys(data).map((d) => {\n        if (!d) {\n            data[d] = \"/\";\n        }\n    });\n    const indexesAreStrings = Object.keys(data).every(i => typeof i === \"string\");\n    const indexesLookLikeAPath = Object.keys(data).every(i => i.indexOf(\"/\") !== -1);\n    return indexesAreStrings && indexesLookLikeAPath ? true : false;\n}\nexport default class Reference extends Query {\n    get key() {\n        return this.path.split(\".\").pop();\n    }\n    get parent() {\n        const r = parts(this.path)\n            .slice(-1)\n            .join(\".\");\n        return new Reference(r, get(db, r));\n    }\n    child(path) {\n        const r = parts(this.path)\n            .concat([path])\n            .join(\".\");\n        return new Reference(r, get(db, r));\n    }\n    get root() {\n        return new Reference(\"/\", db);\n    }\n    push(value, onComplete) {\n        const id = pushDB(this.path, value);\n        this.path = join(this.path, id);\n        if (onComplete) {\n            onComplete(null);\n        }\n        return networkDelay(this); // TODO: try and get this typed appropriately\n    }\n    remove(onComplete) {\n        removeDB(this.path);\n        if (onComplete) {\n            onComplete(null);\n        }\n        return networkDelay();\n    }\n    set(value, onComplete) {\n        setDB(this.path, value);\n        if (onComplete) {\n            onComplete(null);\n        }\n        return networkDelay();\n    }\n    update(values, onComplete) {\n        if (isMultiPath(values)) {\n            multiPathUpdateDB(values);\n        }\n        else {\n            updateDB(this.path, values);\n        }\n        if (onComplete) {\n            onComplete(null);\n        }\n        return networkDelay();\n    }\n    setPriority(priority, onComplete) {\n        return networkDelay();\n    }\n    setWithPriority(newVal, newPriority, onComplete) {\n        return networkDelay();\n    }\n    transaction(transactionUpdate, onComplete, applyLocally) {\n        return Promise.resolve({\n            committed: true,\n            snapshot: null,\n            toJSON() {\n                return {};\n            }\n        });\n    }\n    onDisconnect() {\n        return {};\n    }\n    toString() {\n        return slashNotation(join(\"https://mockdb.local\", this.path, this.key));\n    }\n}\n","const exceptions = {\n    child: 'children',\n    man: 'men',\n    woman: 'women',\n    tooth: 'teeth',\n    foot: 'feet',\n    mouse: 'mice',\n    person: 'people',\n    company: 'companies'\n};\n/**\n * Exceptions when moving from plural to singular\n */\nconst singularExceptions = () => {\n    return Object.keys(pluralize).reduce((agg, k) => agg[exceptions[k]] = k, new Object());\n};\nexport default function pluralize(singular) {\n    const rules = [\n        { find: /(.*)(ch|sh|ax|ss)$/, replace: '$1$2es' },\n        { find: /(.*)(fe|f)$/, replace: '$1ves' },\n        { find: /(.*)us$/, replace: '$1i' }\n    ];\n    for (const r of rules) {\n        if (r.find.test(singular)) {\n            return singular.replace(r.find, r.replace);\n        }\n    }\n    return exceptions[singular] ? exceptions[singular] : `${singular}s`;\n}\n;\nexport const addException = (singular, plural) => {\n    exceptions[singular] = plural;\n};\nexport const singularize = (plural) => {\n    //\n};\n","import Queue from \"./queue\";\nimport SchemaHelper from \"./schema-helper\";\nimport pluralize, { addException } from \"./pluralize\";\nexport default class Schema {\n    constructor(schemaId) {\n        this.schemaId = schemaId;\n        this._schemas = new Queue(\"schemas\");\n        this._relationships = new Queue(\"relationships\");\n        this._prefix = \"\";\n    }\n    /**\n     * Add a mocking function to be used to generate the schema in mock DB\n     */\n    mock(cb) {\n        this._schemas.enqueue({\n            id: this.schemaId,\n            fn: cb(new SchemaHelper({})),\n            path: () => {\n                const schema = this._schemas.find(this.schemaId);\n                return [\n                    schema.prefix,\n                    schema.modelName ? pluralize(schema.modelName) : pluralize(this.schemaId)\n                ].join(\"/\");\n            }\n        });\n        return this;\n    }\n    /**\n     * There are times where it's appropriate to have multiple schemas for\n     * the same entity/model, in this case you'll want to state what model\n     * your schema is emulating. If you don't state this property it assumes\n     * the schema name IS the model name\n     */\n    modelName(value) {\n        this._schemas.update(this.schemaId, { modelName: value });\n        return this;\n    }\n    /** prefixes a static path to the beginning of the  */\n    pathPrefix(prefix) {\n        prefix = prefix.replace(/\\./g, \"/\"); // slash reference preferred over dot\n        prefix = prefix.slice(-1) === \"/\" ? prefix.slice(0, prefix.length - 1) : prefix;\n        this._schemas.update(this.schemaId, { prefix });\n        return this;\n    }\n    /**\n     * The default pluralizer is quite simple so if you find that\n     * it is pluralizing incorrectly then you can manually state\n     * the plural name.\n     */\n    pluralName(plural) {\n        const model = this._schemas.find(this.schemaId).modelName\n            ? this._schemas.find(this.schemaId).modelName\n            : this.schemaId;\n        addException(model, plural);\n        return this;\n    }\n    /**\n     * Configures a \"belongsTo\" relationship with another schema/entity\n     */\n    belongsTo(target, sourceProperty) {\n        this._relationships.push({\n            type: \"belongsTo\",\n            source: this.schemaId,\n            target,\n            sourceProperty: sourceProperty ? sourceProperty : `${target}Id`\n        });\n        return this;\n    }\n    /**\n     * Configures a \"hasMany\" relationship with another schema/entity\n     */\n    hasMany(target, sourceProperty) {\n        this._relationships.push({\n            type: \"hasMany\",\n            source: this.schemaId,\n            target,\n            sourceProperty: sourceProperty ? sourceProperty : pluralize(target)\n        });\n        return this;\n    }\n    /** Add another schema */\n    addSchema(schema, mock) {\n        const s = new Schema(schema);\n        if (mock) {\n            s.mock(mock);\n        }\n        return new Schema(schema);\n    }\n}\n","import * as fbKey from \"firebase-key\";\nimport { set, get, first } from \"lodash\";\nimport { getRandomInt, dotNotation } from \"./util\";\nimport Queue from \"./queue\";\nimport pluralize from \"./pluralize\";\nimport { db } from \"./database\";\nexport default class Deployment {\n    constructor() {\n        this._queue = new Queue(\"queue\");\n        this._schemas = new Queue(\"schemas\");\n        this._relationships = new Queue(\"relationships\");\n    }\n    /**\n     * Queue a schema for deployment to the mock DB\n     */\n    queueSchema(\n    /** A unique reference to the schema being queued for generation */\n    schemaId, \n    /** The number of this schema to generate */\n    quantity = 1, \n    /** Properties in the schema template which should be overriden with a static value */\n    overrides = {}) {\n        this.schemaId = schemaId;\n        this.queueId = fbKey.key();\n        const schema = this._schemas.find(schemaId);\n        if (!schema) {\n            console.log(`Schema \"${schema}\" does not exist; will SKIP.`);\n        }\n        else {\n            const newQueueItem = {\n                id: this.queueId,\n                schema: schemaId,\n                prefix: schema.prefix,\n                quantity,\n                overrides\n            };\n            this._queue.enqueue(newQueueItem);\n        }\n        return this;\n    }\n    /**\n     * Provides specificity around how many of a given\n     * \"hasMany\" relationship should be fulfilled of\n     * the schema currently being queued.\n     */\n    quantifyHasMany(targetSchema, quantity) {\n        const hasMany = this._relationships.filter(r => r.type === \"hasMany\" && r.source === this.schemaId);\n        const targetted = hasMany.filter(r => r.target === targetSchema);\n        if (hasMany.length === 0) {\n            console.log(`Attempt to quantify \"hasMany\" relationships with schema \"${this.schemaId}\" is not possible; no such relationships exist`);\n        }\n        else if (targetted.length === 0) {\n            console.log(`The \"${targetSchema}\" schema does not have a \"hasMany\" relationship with the \"${this.schemaId}\" model`);\n        }\n        else {\n            const queue = this._queue.find(this.queueId);\n            this._queue.update(this.queueId, {\n                hasMany: Object.assign({}, queue.hasMany, { [pluralize(targetSchema)]: quantity })\n            });\n        }\n        return this;\n    }\n    /**\n     * Indicates the a given \"belongsTo\" should be fulfilled with a\n     * valid FK reference when this queue is generated.\n     */\n    fulfillBelongsTo(targetSchema) {\n        const schema = this._schemas.find(this.schemaId);\n        const relationship = first(this._relationships\n            .filter(r => r.source === this.schemaId)\n            .filter(r => r.target === targetSchema));\n        const sourceProperty = schema.path();\n        const queue = this._queue.find(this.queueId);\n        this._queue.update(this.queueId, {\n            belongsTo: Object.assign({}, queue.belongsTo, { [`${targetSchema}Id`]: true })\n        });\n        return this;\n    }\n    generate() {\n        this._queue.map((q) => {\n            for (let i = q.quantity; i > 0; i--) {\n                this.insertMockIntoDB(q.schema, q.overrides);\n            }\n        });\n        this._queue.map((q) => {\n            for (let i = q.quantity; i > 0; i--) {\n                this.insertRelationshipLinks(q);\n            }\n        });\n        this._queue.clear();\n    }\n    insertMockIntoDB(schemaId, overrides) {\n        const schema = this._schemas.find(schemaId);\n        const mock = schema.fn();\n        const path = schema.path();\n        const key = fbKey.key();\n        set(db, dotNotation(path) + `.${key}`, typeof mock === \"object\"\n            ? Object.assign({}, mock, overrides) : overrides && typeof overrides !== \"object\"\n            ? overrides\n            : mock);\n        return key;\n    }\n    insertRelationshipLinks(queue) {\n        const relationships = this._relationships.filter(r => r.source === queue.schema);\n        const belongsTo = relationships.filter(r => r.type === \"belongsTo\");\n        const hasMany = relationships.filter(r => r.type === \"hasMany\");\n        belongsTo.forEach(r => {\n            const fulfill = Object.keys(queue.belongsTo || {})\n                .filter(v => queue.belongsTo[v] === true)\n                .indexOf(r.sourceProperty) !== -1;\n            const source = this._schemas.find(r.source);\n            const target = this._schemas.find(r.target);\n            let getID;\n            if (fulfill) {\n                const mockAvailable = this._schemas.find(r.target) ? true : false;\n                const available = Object.keys(db[pluralize(r.target)] || {});\n                const generatedAvailable = available.length > 0;\n                const numChoices = (db[r.target] || []).length;\n                const choice = () => generatedAvailable\n                    ? available[getRandomInt(0, available.length - 1)]\n                    : this.insertMockIntoDB(r.target, {});\n                getID = () => mockAvailable\n                    ? generatedAvailable\n                        ? choice()\n                        : this.insertMockIntoDB(r.target, {})\n                    : fbKey.key();\n            }\n            else {\n                getID = () => \"\";\n            }\n            const property = r.sourceProperty;\n            const path = source.path();\n            const recordList = get(db, dotNotation(source.path()), {});\n            Object.keys(recordList).forEach(key => {\n                set(db, `${dotNotation(source.path())}.${key}.${property}`, getID());\n            });\n        });\n        hasMany.forEach(r => {\n            const fulfill = Object.keys(queue.hasMany || {}).indexOf(r.sourceProperty) !== -1;\n            const howMany = fulfill ? queue.hasMany[r.sourceProperty] : 0;\n            const source = this._schemas.find(r.source);\n            const target = this._schemas.find(r.target);\n            let getID;\n            if (fulfill) {\n                const mockAvailable = this._schemas.find(r.target) ? true : false;\n                const available = Object.keys(db[pluralize(r.target)] || {});\n                const used = [];\n                const generatedAvailable = available.length > 0;\n                const numChoices = (db[pluralize(r.target)] || []).length;\n                const choice = (pool) => {\n                    if (pool.length > 0) {\n                        const chosen = pool[getRandomInt(0, pool.length - 1)];\n                        used.push(chosen);\n                        return chosen;\n                    }\n                    return this.insertMockIntoDB(r.target, {});\n                };\n                getID = () => mockAvailable\n                    ? choice(available.filter(a => used.indexOf(a) === -1))\n                    : fbKey.key();\n            }\n            else {\n                getID = () => undefined;\n            }\n            const property = r.sourceProperty;\n            const path = source.path();\n            const sourceRecords = get(db, dotNotation(source.path()), {});\n            Object.keys(sourceRecords).forEach(key => {\n                for (let i = 1; i <= howMany; i++) {\n                    set(db, `${dotNotation(source.path())}.${key}.${property}.${getID()}`, true);\n                }\n            });\n        });\n    }\n}\n"],"names":["get","set","fbKey","reset","Mock","convert.arrayToHash","fbKey.key","first","convert.hashToArray"],"mappings":"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"}